{% extends '::base.html.twig' %}


{% block body %}

    <ol class="breadcrumb">
        <li><a href="{{ path('agil_forum_homepage') }}">Accueil Forum</a></li>
        <li><a href="{{ path('agil_forum_subjects_list',{'idCategory' : category.forumCategoryId}) }}">{{ category.forumCategoryName }}</a></li>
        <li class="active">{{ subject.forumSubjectTitle }}</li>
    </ol>


    <div class="row">
        <div class="col-sm-12 col-xs-12 col-md-12 col-lg-12">
            <h3>{{ subject.forumSubjectTitle }}</h3>
            <h5>{{ subject.forumSubjectDescription }}</h5>

            {% if subject.forumSubjectIsResolved %}
                <div class="alert alert-success" role="alert">Ce sujet est résolu</div>
            {% else %}

                {% if app.user.username == subject.user.username %}
                    <a href="{{ path('agil_forum_subject_to_resolve',{'idCategory' : category.forumCategoryId,'idSubject' : subject.forumSubjectId}) }}" class="btn btn-default">Mettre comme résolu</a>
                {% endif %}
                <br/><br/>
            {% endif %}

            {% for a in answers %}

                <!-- Un message -->
                <div class="panel forum_message">
                    <div class="panel-heading">
                        <div class="row">
                            <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
                                <span class="text-left h3">
                                    <a href="#">{{ a.username }}</a>
                                </span>
                            </div>
                            <div class="col-xs-10 col-sm-10 col-md-10 col-lg-10 text-right">
                                <span class="text-right"><em class="blue">Il y a {{ relativeDate[a.forumAnswerId] }} ({{ a.forumAnswerPostDate|date('j M Y - H:i:s') }})</em></span>
                            </div>
                        </div>
                    </div>
                    <div class="panel-body">
                        <div class="row">
                            <div class="col-sm-2 col-md-2 col-lg-2 hidden-xs">
                                <div class="embed-responsive embed-responsive-4by3">
                                    <img class="center-block img-circle img-responsive" src="http://lorempicsum.com/simpsons/140/140/5"/>
                                </div>

                                <div class="user_info text-center">

                                    <strong>
                                        {% if a.roles|length == 0 %}
                                            MEMBRE
                                        {% else %}
                                            {% if a.roles[0] == "ROLE_SUPER_ADMIN" %}
                                                SUPER ADMINISTRATEUR
                                            {% elseif a.roles[0] == "ROLE_ADMIN" %}
                                                ADMINISTRATEUR
                                            {% elseif a.roles[0] == "ROLE_MODERATOR" %}
                                                ANIMATEUR-MODERATEUR
                                            {% endif %}
                                        {% endif %}
                                    </strong>
                                    <div class="text-center">

                                        {% for skill in userTagsSkills[a.id] %}
                                            <span class="label label-default">{{ skill.tag.tagName }}</span>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-10 col-md-10 col-lg-10">
                                <br/>

                                <!-- Contenu du message -->
                                <p>{{ a.forumAnswerText|raw }}</p>


                            </div>

                        </div>
                    </div>
                    <div class="forum_message_function">
                        <div class="row">
                            <div class="col-sm-2 col-md-2 col-lg-2">
                            </div>
                            <div class="col-sm-10 col-md-10 col-lg-10 text-right">

                                {% if is_granted('ROLE_MODERATOR') %}
                                    <a class="btn btn-danger" href="#" role="button">Supprimer</a>
                                {% endif %}
                                {% if app.user.username == a.username %}
                                    <a class="btn btn-default" href="{{ path('agil_forum_answers_edit',{'idCategory' : category.forumCategoryId,'idSubject' : subject.forumSubjectId,'idAnswer' : a.forumAnswerId}) }}" role="button">Editer</a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>

            {% endfor %}
        </div>

        <nav class="text-center">
            {% include 'AGILForumBundle:Answers:pagination.html.twig' %}
        </nav>

    </div>


    <!-- Partie pour répondre au sujet -->
    <div class="panel-body">

        <!-- Formulaire de d'ajout de réponse pour le sujet -->

        <form action="{{ path('agil_forum_subject_answers', {'idCategory': category.forumCategoryId, 'idSubject': subject.forumSubjectId}) }}" method="post" {{ form_enctype(form) }}>

            <div class="form-group" id="formAddContentPost">
                <label for="inputContentPost" class="col-sm-2 control-label"><strong>Post</strong></label>
                <div class="col-xs-10 col-sm-10 col-md-10 col-lg-10">
                    {{ form_errors(form.forumAnswerText) }}
                    {{ form_row(form.forumAnswerText) }}

                </div>
            </div>

            <div class="form-group">
                <div class="col-sm-offset-2 col-sm-10">
                    {{ form_row(form.Ajouter) }}
                </div>
            </div>
            {{ tinymce_init({
                selector: 'forumAnswerText',
                menu: {
                    file: {title: 'File', items: 'newdocument'},
                    edit: {title: 'Edit', items: 'undo redo | cut copy paste pastetext | selectall'},
                    insert: {title: 'Insert', items: 'link media | template hr'},
                    view: {title: 'View', items: 'visualaid'},
                    format: {title: 'Format', items: 'bold italic underline strikethrough superscript subscript | formats | removeformat'},
                    table: {title: 'Table', items: 'inserttable tableprops deletetable | cell row column'},
                    tools: {title: 'Tools', items: 'spellchecker code'}
                }
            })
            }}
            {{ form_rest(form) }}
        </form>
    </div>



    <div class="reponse">
        <form class="form-horizontal">
            <div class="form-group">
                <textarea class="form-control" rows="3" id="inputEmail3"></textarea>
            </div>
            <div class="form-group">
                <button type="submit" class="btn btn-default">Preview</button>
                <button type="submit" class="btn btn-default">Envoyer</button>
            </div>
        </form>
    </div>






    <br>



{% endblock %}